(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{deWh:function(e,t,n){"use strict";n.r(t),n.d(t,"DashboardModule",function(){return L});var r=n("0S4P"),a=n("JAnZ"),o=n("Dxy4"),i=n("ZTz/"),s=n("Q2Ze"),c=n("o4Yh"),l=n("XFzh"),p=n("0xS5"),m=n("A9uA"),d=n("vOrQ"),u=n("3xDq"),f=n("cIEA"),g=n("/uUt"),h=n("pcbr"),v=n("p+Sl"),C=n("mW00"),y=n("pk7b");function E(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275elementStart"](1,"nz-timeline-item"),d["\u0275\u0275element"](2,"div",3),d["\u0275\u0275pipe"](3,"safe"),d["\u0275\u0275text"](4),d["\u0275\u0275pipe"](5,"date"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("innerHTML",d["\u0275\u0275pipeBind2"](3,2,e.text,"html"),d["\u0275\u0275sanitizeHtml"]),d["\u0275\u0275advance"](2),d["\u0275\u0275textInterpolate1"](" - ",d["\u0275\u0275pipeBind2"](5,5,1e3*e.date,"dd/MM/yyyy \xe0 HH:mm")," ")}}function x(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275elementStart"](1,"h3"),d["\u0275\u0275text"](2,"\xc9v\xe9nements r\xe9cents"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](3,"nz-timeline"),d["\u0275\u0275template"](4,E,6,8,"ng-container",2),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementContainerEnd"]()),2&e){const e=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("ngForOf",e.events)("ngForTrackBy",e.trackById)}}function S(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"h2"),d["\u0275\u0275text"](1,"Aucun \xe9v\xe9nement important n'est \xe0 signaler !"),d["\u0275\u0275elementEnd"]())}function b(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"nz-empty",4),d["\u0275\u0275template"](1,S,2,0,"ng-template",null,5,d["\u0275\u0275templateRefExtractor"]),d["\u0275\u0275elementEnd"]()),2&e){const e=d["\u0275\u0275reference"](2);d["\u0275\u0275property"]("nzNotFoundContent",e)}}let F=(()=>{class e{constructor(){this.events=[]}ngOnChanges(){this.events&&(this.events=this.events.sort((e,t)=>t.date-e.date))}trackById(e,t){return t.id}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=d["\u0275\u0275defineComponent"]({type:e,selectors:[["ws-resource-events"]],inputs:{events:"events"},features:[d["\u0275\u0275NgOnChangesFeature"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noevent",""],[4,"ngFor","ngForOf","ngForTrackBy"],[2,"display","inline-block",3,"innerHTML"],[3,"nzNotFoundContent"],["content",""]],template:function(e,t){if(1&e&&(d["\u0275\u0275template"](0,x,5,2,"ng-container",0),d["\u0275\u0275template"](1,b,3,1,"ng-template",null,1,d["\u0275\u0275templateRefExtractor"])),2&e){const e=d["\u0275\u0275reference"](2);d["\u0275\u0275property"]("ngIf",t.events.length)("ngIfElse",e)}},directives:[r.NgIf,v.a,r.NgForOf,v.b,C.b],pipes:[y.a,r.DatePipe],styles:[""],changeDetection:0}),e})();var O=n("UhP/"),I=n("ztHp"),k=n("mhHy");function M(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"mat-option",7),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"resourceStatus"),d["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;d["\u0275\u0275property"]("value",e),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"](" ",d["\u0275\u0275pipeBind2"](2,2,e,"label")," ")}}function D(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275elementStart"](1,"mat-form-field",4),d["\u0275\u0275elementStart"](2,"mat-label"),d["\u0275\u0275text"](3,"Status"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](4,"mat-select",5),d["\u0275\u0275template"](5,M,3,5,"mat-option",6),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementContainerEnd"]()),2&e){const e=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](4),d["\u0275\u0275property"]("formControl",e.statusControl),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngForOf",e.status)}}const P=function(e,t){return{circle:e,status:t,types:"EXERCISE|ACTIVITY"}};function w(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275elementStart"](1,"a",9),d["\u0275\u0275elementStart"](2,"nz-tag",10),d["\u0275\u0275pipe"](3,"resourceStatus"),d["\u0275\u0275text"](4),d["\u0275\u0275pipe"](5,"resourceStatus"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit,n=d["\u0275\u0275nextContext"](2);d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("queryParams",d["\u0275\u0275pureFunction2"](10,P,n.context.resource.id,e))("queryParamsHandling","merge"),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("nzColor",d["\u0275\u0275pipeBind2"](3,4,e,"color")),d["\u0275\u0275advance"](2),d["\u0275\u0275textInterpolate1"](" ",d["\u0275\u0275pipeBind2"](5,7,e,"label")," 0 ")}}function B(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275elementStart"](1,"mat-expansion-panel",2),d["\u0275\u0275elementStart"](2,"mat-expansion-panel-header"),d["\u0275\u0275elementStart"](3,"span"),d["\u0275\u0275text"](4,"Status des ressources"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275template"](5,w,6,13,"ng-container",8),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementContainerEnd"]()),2&e){const e=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("ngForOf",e.status)}}const T=function(e){return["/profile",e]};function z(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275elementStart"](1,"a",11),d["\u0275\u0275element"](2,"auth-avatar",12),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](2,T,e.id)),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("user",e)}}function A(e,t){if(1&e&&(d["\u0275\u0275elementContainerStart"](0),d["\u0275\u0275elementStart"](1,"a",11),d["\u0275\u0275element"](2,"auth-avatar",12),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("routerLink",d["\u0275\u0275pureFunction1"](2,T,e.id)),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("user",e)}}let R=(()=>{class e{constructor(e,t){this.detailService=e,this.changeDetector=t,this.subscriptions=[],this.status=["DRAFT","READY","BUGGED","NOT_TESTED","DEPRECATED"],this.statusControl=new u.FormControl("",[u.Validators.required]),this.context={state:"LOADING",events:[],members:[]},this.admins=[],this.members=[]}ngOnInit(){this.subscriptions.push(this.detailService.context.subscribe(e=>{var t;this.context=e,this.statusControl.enable(),this.context.isAdmin||this.statusControl.disable(),"READY"===e.state&&"CIRCLE"!==(null===(t=e.resource)||void 0===t?void 0:t.type)&&this.statusControl.patchValue(e.resource.status),this.admins=[],this.members=[],e.members.forEach(e=>{e.isAdmin?this.admins.push(e):this.members.push(e)}),this.changeDetector.markForCheck()})),this.subscriptions.push(this.statusControl.valueChanges.pipe(Object(g.a)()).subscribe(e=>{const t=Object(f.g)(this.context.resource);e!==t.status&&(t.status=e,this.detailService.update(t))}))}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}trackById(e,t){return t.id}}return e.\u0275fac=function(t){return new(t||e)(d["\u0275\u0275directiveInject"](h.a),d["\u0275\u0275directiveInject"](d.ChangeDetectorRef))},e.\u0275cmp=d["\u0275\u0275defineComponent"]({type:e,selectors:[["app-circle-dashboard"]],decls:15,vars:7,consts:[[3,"events"],[4,"ngIf"],["expanded","true"],[4,"ngFor","ngForOf","ngForTrackBy"],["appearance","fill"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[4,"ngFor","ngForOf"],["routerLink","['/workspace/search']",1,"status-item",3,"queryParams","queryParamsHandling"],[3,"nzColor"],["mat-button","",1,"link-profile",3,"routerLink"],[3,"user"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"section"),d["\u0275\u0275element"](1,"ws-resource-events",0),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](2,"aside"),d["\u0275\u0275template"](3,D,6,2,"ng-container",1),d["\u0275\u0275template"](4,B,6,1,"ng-container",1),d["\u0275\u0275elementStart"](5,"mat-expansion-panel",2),d["\u0275\u0275elementStart"](6,"mat-expansion-panel-header"),d["\u0275\u0275elementStart"](7,"span"),d["\u0275\u0275text"](8,"Administrateurs"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275template"](9,z,3,4,"ng-container",3),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](10,"mat-expansion-panel",2),d["\u0275\u0275elementStart"](11,"mat-expansion-panel-header"),d["\u0275\u0275elementStart"](12,"span"),d["\u0275\u0275text"](13,"Membres"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275template"](14,A,3,4,"ng-container",3),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("events",t.context.events),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf","CIRCLE"!==t.context.resource.type),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngIf","CIRCLE"===t.context.resource.type),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("ngForOf",t.admins)("ngForTrackBy",t.trackById),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("ngForOf",t.members)("ngForTrackBy",t.trackById))},directives:[F,r.NgIf,c.b,c.c,r.NgForOf,s.c,s.g,i.a,u.NgControlStatus,u.FormControlDirective,O.f,a.RouterLinkWithHref,l.a,o.a,I.a],pipes:[k.a],styles:["[_nghost-%COMP%]{display:grid;grid-template-columns:6fr 2fr;-moz-column-gap:12px;column-gap:12px}mat-form-field[_ngcontent-%COMP%]{width:100%}.status-item[_ngcontent-%COMP%], mat-expansion-panel[_ngcontent-%COMP%]{margin-bottom:8px}.status-item[_ngcontent-%COMP%]{cursor:pointer;display:block;width:100%}.status-item[_ngcontent-%COMP%]   nz-tag[_ngcontent-%COMP%]{width:100%}.link-profile[_ngcontent-%COMP%]{display:inline-block;margin-bottom:8px}.mat-expansion-panel-body[_ngcontent-%COMP%]{padding:0 24px 12px}.spacer[_ngcontent-%COMP%]{flex:1}"],changeDetection:0}),e})(),L=(()=>{class e{}return e.\u0275mod=d["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=d["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[],imports:[[r.CommonModule,u.ReactiveFormsModule,a.RouterModule.forChild([{path:"",component:R}]),o.c,i.b,s.e,c.a,l.b,p.e,m.a]]}),e})()}}]);