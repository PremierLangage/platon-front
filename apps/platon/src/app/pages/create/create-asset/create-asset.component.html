<header>
  <h1>Nouvelle asset</h1>
  <div class="spacer"></div>
  <button *ngIf="!creating" mat-icon-button (click)="dismiss()">
    <i
      nz-icon
      nzType="close-circle"
      nzTheme="outline"
      style="font-size: 24px"
    ></i>
  </button>
</header>
<main>
  <nz-skeleton [nzActive]="loading" [nzLoading]="loading">
    <ui-stepper #stepper (didSubmit)="onSubmit()">
      <!-- STEP 1 -->
      <ng-template uiStepperStep stepTitle="Type" stepIcon="appstore-add">
        <section>
          <h2>Quel type d'asset voulez-vous créer ?</h2>
          <nz-select
            nzShowSearch
            nzPlaceHolder="Selectionnez un type d'asset"
            [(ngModel)]="selectedType"
            [nzShowArrow]="false"
          >
            <nz-option
              *ngFor="let type of types"
              [nzLabel]="type | assetName"
              [nzValue]="type"
            >
            </nz-option>
          </nz-select>
        </section>
      </ng-template>
      <!-- STEP 2 -->
      <ng-template uiStepperStep stepTitle="Information" stepIcon="info-circle">
        <section>
          <h2>Saisissez les informations de votre exercice</h2>
          <!-- <form [formGroup]="formInfos">
            <mat-form-field appearance="fill">
              <mat-label>Nom</mat-label>
              <input matInput formControlName="name" />
            </mat-form-field>
            <mat-form-field appearance="fill">
              <mat-label>Description</mat-label>
              <textarea
                cdkTextareaAutosize
                matInput
                formControlName="desc"
              ></textarea>
            </mat-form-field>
          </form> -->

          <form [formGroup]="form">
            <formly-form
              [form]="form"
              [fields]="fields"
              [model]="model"
            ></formly-form>
          </form>
        </section>
      </ng-template>
    </ui-stepper>
  </nz-skeleton>
</main>
<footer>
  <ng-container *ngIf="creating; else showControls">
    <nz-spin nzTip="Création du nouvel exercice..."></nz-spin>
  </ng-container>
  <ng-template #showControls>
    <button
      *ngIf="!stepper.isFirst"
      mat-button
      [disabled]="stepper.isFirst"
      (click)="stepper.prevStep()"
    >
      Précedent
    </button>
    <button
      mat-button
      color="primary"
      [disabled]="!stepper.isValid"
      (click)="stepper.nextStep()"
    >
      {{ stepper.isLast ? 'Créer' : 'Suivant' }}
    </button>
  </ng-template>
</footer>
